{% extends "base.html" %}

{% block content %}
<div class="container">
    <div class="row">
        {% if cart %}
                <table class="table">
                    <thead>
                    <tr>
                        <th scope="col">Изображение</th>
                        <th scope="col">Продукт</th>
                        <th scope="col">Колличество</th>
                        <th scope="col">Удаление</th>
                        <th scope="col">Цена</th>
                        <th scope="col">Общая цена</th>
                    </tr>
                    </thead>
                    <tbody>
                    {% for item in cart %}
                        {% with product=item.product %}
                            <tr>
                                <td>
                                    <a href="{{ product.get_absolute_url }}">
                                        <img src="
                                            {% if product.image %}
                                                {{ product.image.url }}

                                            {% endif %}">
                                    </a>
                                </td>
                                <td class="pt-5">{{ product.title }}</td>
                                <td class="pt-5">
                                    <form action="{% url 'cart_update' product.slug %}" method="POST">
                                        {% csrf_token %}
                                        <input type="hidden" name="quantity" value="1">
                                        <button type="submit" class="btn btn-link p-0 text-info"><i class="fas fa-plus"></i></button>
                                    </form>
                                    {{ item.quantity }}
                                    <form action="{% url 'cart_subtract' product.slug %}" method="POST">
                                        {% csrf_token %}
                                        <input type="hidden" name="update" value="True">
                                        <input type="hidden" name="quantity" value="1">
                                        <button type="submit" class="btn btn-link p-0 text-info"><i class="fas fa-minus"></i></button>
                                    </form>
                                </td>
                                <td class="pt-5"><a href="{% url 'cart_remove' product.slug %}">Убрать</a></td>
                                <td class="num pt-5">₽{{ item.price }}</td>
                                <td class="num pt-5">₽{{ item.total_price }}</td>
                            </tr>
                        {% endwith %}
                    {% endfor %}
                    <tr class="total">
                        <td class="table-danger">Сумма</td>
                        <td class="table-danger" colspan="4"></td>
                        <td class="num table-danger">₽{{ cart.get_total_price }}</td>
                    </tr>
                    </tbody>
                </table>
                <p class="mt-3">
                    <a href="#" class="float-end btn btn-primary ms-3">Оплатить</a>
                    <a href="{% url 'main' %}" class="float-end btn btn-primary">Продолжить шоппинг</a>
                </p>
        {% else %}
            <h2 class="text-center mt-5">Здесь пока ничего нет...</h2>
        {% endif %}
    </div>
</div>
{% endblock %}